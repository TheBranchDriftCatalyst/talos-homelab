# Recovery Patch for talos01
# Removes the WireGuard configuration that caused connectivity loss
# Apply with: talosctl -n 192.168.1.177 patch machineconfig -p @configs/patches/wireguard-remove-talos01.yaml --mode=reboot
#
# RECOVERY STEPS:
# 1. Physically reboot talos01 (power cycle)
# 2. Wait for it to boot (it will have broken networking but Talos API might work briefly)
# 3. Quickly apply this patch: talosctl -n 192.168.1.177 patch machineconfig -p @configs/patches/wireguard-remove-talos01.yaml --mode=reboot
# 4. Or boot into maintenance mode and apply a clean config

# This patch removes the wg0 interface and problematic routes
# by setting the interfaces to only include enp3s0 with default config
machine:
  network:
    interfaces:
      - interface: enp3s0
        dhcp: true
  nodeLabels:
    # Remove the egress-gateway label
    egress-gateway: ""
