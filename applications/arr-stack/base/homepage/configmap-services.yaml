---
apiVersion: v1
kind: ConfigMap
metadata:
  name: homepage-services
  labels:
    app: homepage
    app.kubernetes.io/name: homepage
    app.kubernetes.io/part-of: arr-stack
data:
  services.yaml: |
    ---
    # Homepage Services Configuration
    # Documentation: https://gethomepage.dev/configs/services/

    # Media Management Services
    - Media Management:
        - Sonarr:
            icon: sonarr.png
            href: http://sonarr.talos00
            description: TV Series Management
            widget:
              type: sonarr
              url: http://sonarr.media.svc.cluster.local:8989
              key: {{HOMEPAGE_VAR_SONARR_KEY}}
              fields: ["wanted", "queued", "series"]

        - Radarr:
            icon: radarr.png
            href: http://radarr.talos00
            description: Movie Management
            widget:
              type: radarr
              url: http://radarr.media.svc.cluster.local:7878
              key: {{HOMEPAGE_VAR_RADARR_KEY}}
              fields: ["wanted", "queued", "movies"]

        - Readarr:
            icon: readarr.png
            href: http://readarr.talos00
            description: Book Management
            widget:
              type: readarr
              url: http://readarr.media.svc.cluster.local:8787
              key: {{HOMEPAGE_VAR_READARR_KEY}}
              fields: ["wanted", "queued", "books"]

        - Prowlarr:
            icon: prowlarr.png
            href: http://prowlarr.talos00
            description: Indexer Manager
            widget:
              type: prowlarr
              url: http://prowlarr.media.svc.cluster.local:9696
              key: {{HOMEPAGE_VAR_PROWLARR_KEY}}
              fields: ["numberOfGrabs", "numberOfQueries", "numberOfFailGrabs"]

        - Posterizarr:
            icon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/plex.png
            href: http://posterizarr.talos00
            description: Poster Overlay Generator
            siteMonitor: http://posterizarr.media.svc.cluster.local:8000

    # Download Clients
    - Download Clients:
        - qBittorrent:
            icon: qbittorrent.png
            href: http://qbittorrent.talos00
            description: Torrent Client
            widget:
              type: qbittorrent
              url: http://qbittorrent.media.svc.cluster.local:8080
              username: panda
              password: turbopookipanda
              fields: ["leech", "seed", "download", "upload"]

        - SABnzbd:
            icon: sabnzbd.png
            href: http://sabnzbd.talos00
            description: Usenet Client
            widget:
              type: sabnzbd
              url: http://sabnzbd.media.svc.cluster.local:8080
              key: {{HOMEPAGE_VAR_SABNZBD_KEY}}
              fields: ["rate", "queue", "timeleft"]

    # Media Servers
    - Media Servers:
        - Plex:
            icon: plex.png
            href: http://plex.talos00
            description: Media Server
            widget:
              type: plex
              url: http://plex.media.svc.cluster.local:32400
              key: {{HOMEPAGE_VAR_PLEX_KEY}}
              fields: ["streams", "movies", "tv"]

        - Jellyfin:
            icon: jellyfin.png
            href: http://jellyfin.talos00
            description: Free Media Server
            widget:
              type: jellyfin
              url: http://jellyfin.media.svc.cluster.local:8096
              key: {{HOMEPAGE_VAR_JELLYFIN_KEY}}
              fields: ["movies", "series", "episodes"]

        - Overseerr:
            icon: overseerr.png
            href: http://overseerr.talos00
            description: Request Management
            widget:
              type: overseerr
              url: http://overseerr.media.svc.cluster.local:5055
              key: {{HOMEPAGE_VAR_OVERSEERR_KEY}}
              fields: ["pending", "approved", "available"]

        - Tdarr:
            icon: tdarr.png
            href: http://tdarr.talos00
            description: Media Transcoding
            widget:
              type: tdarr
              url: http://tdarr-server.tdarr.svc.cluster.local:8265
              fields: ["queue", "processed", "errored"]

    # Infrastructure Services
    - Infrastructure:
        - Authentik:
            icon: authentik.png
            href: http://authentik.talos00
            description: Identity Provider (SSO)
            widget:
              type: authentik
              url: http://authentik-server.authentik.svc.cluster.local
              key: {{HOMEPAGE_VAR_AUTHENTIK_KEY}}
              fields: ["users", "loginsLast24h", "failedLoginsLast24h"]

        - ArgoCD:
            icon: argocd.png
            href: http://argocd.talos00
            description: GitOps CD
            siteMonitor: http://argocd-server.argocd.svc.cluster.local

        - Traefik:
            icon: traefik.png
            href: http://traefik.talos00/dashboard/
            description: Ingress Controller
            widget:
              type: traefik
              url: http://traefik-internal.traefik.svc.cluster.local:9000
              fields: ["routers", "services", "middleware"]

        - Nexus:
            icon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/nexus-sonatype.png
            href: http://nexus.talos00
            description: Artifact Repository (Docker, npm, PyPI)
            siteMonitor: http://nexus.registry.svc.cluster.local:8081

        - MinIO:
            icon: minio.png
            href: http://minio.talos00
            description: Object Storage (S3-compatible)
            siteMonitor: http://minio.minio.svc.cluster.local/minio/health/live

        - Bastion:
            icon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/terminal.png
            href: http://bastion.talos00
            description: Jump Host / Debug Pod
            # Note: Docker stats not available in Kubernetes

    # Monitoring Services
    - Monitoring:
        - Grafana:
            icon: grafana.png
            href: http://grafana.talos00
            description: Metrics Visualization
            widget:
              type: grafana
              url: http://grafana-service.monitoring.svc.cluster.local:3000
              username: {{HOMEPAGE_VAR_GRAFANA_USER}}
              password: {{HOMEPAGE_VAR_GRAFANA_PASS}}
              fields: ["dashboards", "datasources", "totalalerts"]

        - Mimir:
            icon: prometheus.png
            href: http://grafana.talos00/explore?orgId=1&left=%7B%22datasource%22:%22mimir%22%7D
            description: Metrics Storage (Prometheus-compatible)
            # Note: Mimir doesn't have /api/v1/targets endpoint, so no widget

        - Alertmanager:
            icon: alertmanager.png
            href: http://grafana.talos00/alerting/list
            description: Alert Management (via Grafana)

        - Graylog:
            icon: graylog.png
            href: http://graylog.talos00
            description: Log Management (Disabled)

    # Testing & Admin Tools
    - Testing Tools:
        - Headlamp:
            icon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/kubernetes-dashboard.png
            href: http://headlamp.talos00
            description: Kubernetes UI
            namespace: infra-testing

        - Kubeview:
            icon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/kubernetes.png
            href: http://kubeview.talos00
            description: K8s Visualizer
            namespace: infra-testing

        - Goldilocks:
            icon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/goldilocks.png
            href: http://goldilocks.talos00
            description: Resource Recommendations
            namespace: infra-testing

        - Kube Ops View:
            icon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/kubernetes.png
            href: http://kube-ops-view.talos00
            description: Cluster Overview
            namespace: infra-testing

    # VPN & Privacy Tools
    - VPN & Privacy:
        - SecureChrome:
            icon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/chrome.png
            href: https://securechrome.talos00
            description: VPN-protected Chrome (Germany)
            ping: http://secure-chrome.vpn-gateway.svc.cluster.local:6901

        - SecureXNG:
            icon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/searxng.png
            href: http://securexng.talos00
            description: VPN-protected Search (Germany)
            ping: http://securexng.vpn-gateway.svc.cluster.local:8080

  widgets.yaml: |
    ---
    # Homepage Widgets Configuration
    # Documentation: https://gethomepage.dev/configs/info-widgets/

    # Kubernetes cluster information
    - kubernetes:
        cluster:
          show: true
          cpu: true
          memory: true
          showLabel: true
          label: "Talos Cluster"
        nodes:
          show: true
          cpu: true
          memory: true
          showLabel: true

    # System resources (requires host access)
    - resources:
        label: "Homepage Pod"
        cpu: true
        memory: true
        expanded: false

    # Search bar
    - search:
        provider: duckduckgo
        target: _blank

    # Date and time
    - datetime:
        text_size: xl
        format:
          dateStyle: long
          timeStyle: short
          hourCycle: h12

  bookmarks.yaml: |
    ---
    # Homepage Bookmarks Configuration
    # Documentation: https://gethomepage.dev/configs/bookmarks/

    - Documentation:
        - Kubernetes Docs:
            - icon: kubernetes.png
              href: https://kubernetes.io/docs/
              description: Official K8s Documentation

        - Talos Linux:
            - icon: https://www.talos.dev/images/logo.svg
              href: https://www.talos.dev/
              description: Talos OS Documentation

        - Homepage Docs:
            - icon: homepage.png
              href: https://gethomepage.dev/
              description: Homepage Dashboard Docs

    - GitHub Repos:
        - This Repo:
            - icon: github.png
              href: https://github.com/TheBranchDriftCatalyst/talos-homelab
              description: Talos Homelab Repository

        - Catalyst DevSpace:
            - icon: github.png
              href: https://github.com/TheBranchDriftCatalyst/catalyst-devspace
              description: Main Development Workspace

    - Tools:
        - Traefik Docs:
            - icon: traefik.png
              href: https://doc.traefik.io/traefik/
              description: Traefik Documentation

        - ArgoCD Docs:
            - icon: argocd.png
              href: https://argo-cd.readthedocs.io/
              description: ArgoCD Documentation

        - Helm Hub:
            - icon: helm.png
              href: https://artifacthub.io/
              description: Artifact Hub

  docker.yaml: |
    ---
    # Homepage Docker Configuration
    # Documentation: https://gethomepage.dev/configs/docker/

    # This file is used for Docker socket integration
    # Not applicable for Kubernetes deployments
    # The equivalent functionality is provided via:
    # - Kubernetes widget in widgets.yaml
    # - ServiceAccount with RBAC permissions in serviceaccount.yaml
    # - Container status via Kubernetes API
