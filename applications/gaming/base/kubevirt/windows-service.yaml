---
# Service for RDP access to Windows VM
apiVersion: v1
kind: Service
metadata:
  name: windows-gameserver-rdp
  labels:
    app: windows-gameserver
spec:
  type: NodePort
  selector:
    kubevirt.io/domain: windows-gameserver
  ports:
    - name: rdp
      port: 3389
      targetPort: 3389
      nodePort: 30389
      protocol: TCP
---
# Service for Conan Exiles Dedicated Server ports (UDP)
# Default ports from Dedicated Server Launcher
apiVersion: v1
kind: Service
metadata:
  name: conan-exiles-game
  labels:
    app: windows-gameserver
    game: conan-exiles
spec:
  type: NodePort
  selector:
    kubevirt.io/domain: windows-gameserver
  ports:
    - name: game-client
      port: 7777
      targetPort: 7777
      nodePort: 30777
      protocol: UDP
    - name: raw-udp
      port: 7778
      targetPort: 7778
      nodePort: 30778
      protocol: UDP
    - name: steam-query
      port: 27015
      targetPort: 27015
      nodePort: 30015
      protocol: UDP
---
# TCP services for Conan Exiles (RCON + Web)
apiVersion: v1
kind: Service
metadata:
  name: conan-exiles-tcp
  labels:
    app: windows-gameserver
    game: conan-exiles
spec:
  type: NodePort
  selector:
    kubevirt.io/domain: windows-gameserver
  ports:
    - name: rcon
      port: 25575
      targetPort: 25575
      nodePort: 30575
      protocol: TCP
    - name: web
      port: 80
      targetPort: 80
      nodePort: 30080
      protocol: TCP
