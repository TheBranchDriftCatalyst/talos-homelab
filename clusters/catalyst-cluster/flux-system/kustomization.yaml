apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  # Flux components (added by flux bootstrap)
  - flux-system/gotk-components.yaml
  - flux-system/gotk-sync.yaml

  # Cluster-wide settings ConfigMap (used by Flux postBuild substitution)
  - ../cluster-settings.yaml

  # Flux Kustomizations (each has postBuild for variable substitution)
  # Core infrastructure (order matters via dependsOn)
  - ../namespaces.yaml
  - ../storage.yaml
  - ../cert-manager.yaml
  - ../cert-manager-issuers.yaml
  - ../minio.yaml
  - ../traefik.yaml
  - ../external-secrets.yaml # Contains both external-secrets-operator and external-secrets
  - ../registry.yaml
  - ../infra-control.yaml
  - ../intel-gpu.yaml  # NFD + Intel GPU device plugin
  - ../monitoring.yaml
  - ../monitoring-v2-operators.yaml
  - ../monitoring-v2-otel.yaml
  - ../observability.yaml
  - ../argocd.yaml
  - ../flux-notifications.yaml
  - ../kube-system.yaml
  - ../grafana-instances.yaml
  # Applications
  - ../arr-stack.yaml
