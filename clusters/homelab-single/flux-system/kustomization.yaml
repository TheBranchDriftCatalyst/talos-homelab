apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  # Flux components (added by flux bootstrap)
  - flux-system/gotk-components.yaml
  - flux-system/gotk-sync.yaml

  # Cluster-wide settings (used by postBuild substitution)
  - ../cluster-settings.yaml

  # Infrastructure managed by Flux
  - ../../../infrastructure/base/namespaces
  - ../../../infrastructure/base/storage
  - ../../../infrastructure/base/external-secrets
  - ../../../infrastructure/base/flux-notifications
  - ../../../infrastructure/base/monitoring
  - ../../../infrastructure/base/observability

  # Applications managed by Flux
  - ../../../applications/arr-stack/base

# Post-build variable substitution from cluster-settings ConfigMap
postBuild:
  substitute: {}
  substituteFrom:
    - kind: ConfigMap
      name: cluster-settings
