# Example ExternalSecret - demonstrates how to use 1Password with ESO
# This file is for reference only and should be adapted for your use case
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: example-secret
  namespace: default
spec:
  # Refresh interval
  refreshInterval: 1h

  # Reference to the ClusterSecretStore
  secretStoreRef:
    name: onepassword
    kind: ClusterSecretStore

  # Target Kubernetes secret to create/update
  target:
    name: example-secret
    creationPolicy: Owner
    template:
      # Optional: add annotations/labels to the created secret
      metadata:
        labels:
          app: example
      # Optional: customize the secret type
      type: Opaque

  # Data to fetch from 1Password
  data:
    # Simple key mapping
    - secretKey: password
      remoteRef:
        key: example-item # 1Password item name or UUID
        property: password # Field in the 1Password item

    # Multiple fields from the same item
    - secretKey: username
      remoteRef:
        key: example-item
        property: username

    # API keys or tokens
    - secretKey: api-key
      remoteRef:
        key: api-credentials
        property: credential

  # Alternative: fetch all fields from an item
  # dataFrom:
  #   - extract:
  #       key: example-item  # All fields from this item will be synced
