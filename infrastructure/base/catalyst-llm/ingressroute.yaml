---
# IngressRoute for Catalyst LLM API via scaler (scale-to-zero)
# Routes through llm-scaler which manages EC2 worker lifecycle
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: catalyst-llm-api
  namespace: catalyst-llm
  labels:
    app.kubernetes.io/name: catalyst-llm
    app.kubernetes.io/component: ingress
  annotations:
    description: "Scale-to-zero LLM proxy - auto starts/stops EC2 worker"
spec:
  entryPoints:
    - web
  routes:
    - match: Host(`llm.talos00`)
      kind: Rule
      services:
        - name: llm-scaler
          port: 8080
---
# IngressRoute for Ollama via scaler (scale-to-zero)
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: ollama
  namespace: catalyst-llm
  labels:
    app.kubernetes.io/name: catalyst-llm
    app.kubernetes.io/component: ingress
  annotations:
    description: "Scale-to-zero Ollama - auto starts/stops EC2 worker"
spec:
  entryPoints:
    - web
  routes:
    - match: Host(`ollama.talos00`)
      kind: Rule
      services:
        - name: llm-scaler
          port: 8080
---
# IngressRoute for direct Ollama access (bypasses scaler, worker must be running)
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: ollama-direct
  namespace: catalyst-llm
  labels:
    app.kubernetes.io/name: catalyst-llm
    app.kubernetes.io/component: ingress
  annotations:
    description: "Direct Ollama access - bypasses scaler, worker must be running"
spec:
  entryPoints:
    - web
  routes:
    - match: Host(`ollama-direct.talos00`)
      kind: Rule
      services:
        - name: ollama-remote
          port: 11434
---
# IngressRoute for Open-WebUI
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: open-webui
  namespace: catalyst-llm
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: ingress
spec:
  entryPoints:
    - web
  routes:
    - match: Host(`chat.talos00`)
      kind: Rule
      services:
        - name: open-webui
          port: 8080
---
# IngressRoute for SillyTavern
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: sillytavern
  namespace: catalyst-llm
  labels:
    app.kubernetes.io/name: sillytavern
    app.kubernetes.io/component: ingress
spec:
  entryPoints:
    - web
  routes:
    - match: Host(`sillytavern.talos00`)
      kind: Rule
      services:
        - name: sillytavern
          port: 8000
---
# IngressRoute for SearXNG
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: searxng
  namespace: catalyst-llm
  labels:
    app.kubernetes.io/name: searxng
    app.kubernetes.io/component: ingress
spec:
  entryPoints:
    - web
  routes:
    - match: Host(`searxng.talos00`)
      kind: Rule
      services:
        - name: searxng
          port: 8080
