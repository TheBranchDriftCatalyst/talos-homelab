---
# TempoMonolithic CR - managed by Tempo Operator
# Single-binary Tempo deployment for homelab
apiVersion: tempo.grafana.com/v1alpha1
kind: TempoMonolithic
metadata:
  name: tempo
  namespace: monitoring
spec:
  # Storage configuration
  storage:
    traces:
      backend: pv
      size: 30Gi

  # Ingestion - OTLP receivers
  ingestion:
    otlp:
      grpc:
        enabled: true
      http:
        enabled: true

  # Jaeger UI for trace visualization
  jaegerui:
    enabled: true
    route:
      enabled: false  # Use Traefik IngressRoute instead

  # Resources
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      memory: 2Gi

  # Service account
  serviceAccount: tempo

  # Observability - enable ServiceMonitor
  observability:
    metrics:
      serviceMonitors:
        - enabled: true
    tracing:
      sampling_fraction: "1.0"
      jaeger_agent_endpoint: ""

  # Management state
  management: Managed
