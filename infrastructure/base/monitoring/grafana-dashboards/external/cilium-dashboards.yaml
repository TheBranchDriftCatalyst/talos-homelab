---
# GrafanaDashboard CRDs for Cilium and Hubble monitoring
# Dashboard IDs sourced from grafana.com/orgs/isovalent/dashboards
# Using v1.12+ dashboards for modern Cilium versions

# Cilium Agent Metrics Dashboard
# Monitors: cilium-agent pods, BPF operations, endpoint management
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDashboard
metadata:
  name: cilium-agent
  namespace: monitoring
  labels:
    app.kubernetes.io/component: dashboard
    dashboard-category: cilium
spec:
  folder: 'Networking'
  instanceSelector:
    matchLabels:
      dashboards: 'grafana'
  grafanaCom:
    id: 16611
  datasources:
    - inputName: 'DS_PROMETHEUS'
      datasourceName: 'Mimir'
---
# Cilium Operator Metrics Dashboard
# Monitors: cilium-operator, CRD management, IPAM
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDashboard
metadata:
  name: cilium-operator
  namespace: monitoring
  labels:
    app.kubernetes.io/component: dashboard
    dashboard-category: cilium
spec:
  folder: 'Networking'
  instanceSelector:
    matchLabels:
      dashboards: 'grafana'
  grafanaCom:
    id: 16612
  datasources:
    - inputName: 'DS_PROMETHEUS'
      datasourceName: 'Mimir'
---
# Cilium Hubble Metrics Dashboard
# Monitors: Network flows, DNS, HTTP, TCP metrics via Hubble
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDashboard
metadata:
  name: cilium-hubble
  namespace: monitoring
  labels:
    app.kubernetes.io/component: dashboard
    dashboard-category: cilium
spec:
  folder: 'Networking'
  instanceSelector:
    matchLabels:
      dashboards: 'grafana'
  grafanaCom:
    id: 16613
  datasources:
    - inputName: 'DS_PROMETHEUS'
      datasourceName: 'Mimir'
---
# Cilium Flows - Hubble Observer Dashboard
# Visualizes network flows using Hubble data via Loki
# Requires hubble-observer component (deployed in kube-system)
# Source: grafana.com/dashboards/23862 (revision 3)
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDashboard
metadata:
  name: cilium-hubble-flows
  namespace: monitoring
  labels:
    app.kubernetes.io/component: dashboard
    dashboard-category: cilium
spec:
  folder: 'Networking'
  instanceSelector:
    matchLabels:
      dashboards: 'grafana'
  grafanaCom:
    id: 23862
    revision: 3
  envs:
    - name: VAR_HUBBLEOBSERVERNAMESPACE
      value: 'kube-system'
  datasources:
    - inputName: 'DS_LOKI'
      datasourceName: 'Loki'
---
# Cilium Policy Verdicts Dashboard
# Monitors: Network policy enforcement, allow/deny decisions
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDashboard
metadata:
  name: cilium-policy-verdicts
  namespace: monitoring
  labels:
    app.kubernetes.io/component: dashboard
    dashboard-category: cilium
spec:
  folder: 'Networking'
  instanceSelector:
    matchLabels:
      dashboards: 'grafana'
  grafanaCom:
    id: 18015
  datasources:
    - inputName: 'DS_PROMETHEUS'
      datasourceName: 'Mimir'
