# Talos Homelab Project - Infrastructure-Focused Starship Config
# Optimized for Kubernetes, Flux GitOps, and Infrastructure Operations
"$schema" = 'https://starship.rs/config-schema.json'

# Two-line format: Context on top, prompt below
format = """
$directory\
$git_branch\
$git_status\
$git_metrics\
$custom\
$fill\
$kubernetes\
$docker_context\
$memory_usage\
$cmd_duration\
$line_break\
$battery\
$character"""

# Right-side info (same line as first line)
right_format = """
$time\
"""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# LINE 1 - LEFT SIDE: Navigation & Git Status
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[directory]
truncation_length = 4
truncate_to_repo = true
format = "[$path]($style)[$read_only]($read_only_style) "
style = "bold cyan"
read_only = " ğŸ”’"
read_only_style = "red"

[git_branch]
format = "[$symbol$branch(:$remote_branch)]($style) "
symbol = "ğŸŒ¿ "
style = "bold #ff79c6"

[git_status]
format = '([$all_status$ahead_behind]($style) )'
style = "bold #ff5555"
conflicted = "âš”ï¸ "
ahead = "â¬†ï¸ ${count} "
behind = "â¬‡ï¸ ${count} "
diverged = "ğŸ”€ ${ahead_count}â†‘${behind_count}â†“ "
staged = "âœ”ï¸ ${count} "
modified = "âœï¸ ${count} "
deleted = "ğŸ—‘ï¸ ${count} "
untracked = "â“${count} "
stashed = "ğŸ“¦ ${count} "

[git_metrics]
disabled = false
format = '([+$added]($added_style) )([-$deleted]($deleted_style) )'
added_style = "bold green"
deleted_style = "bold red"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# FLUX GITOPS STATUS - The star of the show for this project
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[custom.flux]
description = "Flux GitOps: âœ“=healthy â¸=suspended âœ˜=failed"
disabled = false
when = "test -d flux-system || test -d bootstrap/flux || test -f .flux.yaml"
command = """
flux get kustomizations 2>/dev/null | awk '
NR>1 {
  if ($3 == "True") suspended++
  else if ($4 == "False") failed++
  else ready++
}
END {
  if (suspended > 0) printf "â¸%d", suspended
  else if (failed > 0) printf "âœ˜%d", failed
  else if (ready > 0) printf "âœ“%d", ready
  else printf "?"
}'
"""
format = "[Æ’$output]($style) "
style = "bold #bd93f9"
shell = ["bash", "--noprofile", "--norc"]

[custom.talos]
description = "Talos Node: âœ“=responding âœ˜=unreachable"
disabled = false
when = "test -f configs/talosconfig || test -f talosconfig"
command = """
talosctl version --nodes ${TALOS_NODE:-192.168.1.54} 2>/dev/null | grep -q "Tag" && echo "âœ“" || echo "âœ˜"
"""
format = "[Ï„$output]($style) "
style = "bold #50fa7b"
shell = ["bash", "--noprofile", "--norc"]

[custom.argocd]
description = "ArgoCD Apps: âœ“N=N apps deployed â—‹=no apps"
disabled = false
when = "test -d infrastructure/base/argocd || test -d bootstrap/argocd"
command = """
total=$(kubectl get applications -n argocd --no-headers 2>/dev/null | wc -l | tr -d ' ')
if [ "$total" -gt 0 ]; then
  echo "âœ“$total"
else
  echo "â—‹"
fi
"""
format = "[âˆ$output]($style) "
style = "bold #8be9fd"
shell = ["bash", "--noprofile", "--norc"]

# Fill space between left and right
[fill]
symbol = " "

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# LINE 1 - RIGHT SIDE: Infrastructure Context
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[kubernetes]
disabled = false
format = '[$symbol$context(\($namespace\))]($style) '
symbol = "â˜¸ï¸ "
style = "bold #8be9fd"
# Only show specific contexts to reduce noise
# contexts = [
#   { context_pattern = "admin@homelab.*", style = "bold #50fa7b", symbol = "ğŸ  " },
#   { context_pattern = ".*prod.*", style = "bold #ff5555", symbol = "ğŸ”´ " },
#   { context_pattern = ".*dev.*", style = "bold #f1fa8c", symbol = "ğŸŸ¡ " },
# ]

[docker_context]
disabled = false
format = "[$symbol$context]($style) "
symbol = "ğŸ³ "
style = "bold #00dfff"
only_with_files = false

[memory_usage]
disabled = false
threshold = 75
format = "[$symbol$ram]($style) "
symbol = "ğŸ§  "
style = "bold #ffb86c"

[cmd_duration]
min_time = 2000
format = "[â±ï¸ $duration]($style) "
style = "bold #f1fa8c"
show_milliseconds = false

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# LINE 1 - FAR RIGHT: Time
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[time]
disabled = false
time_format = "%H:%M"
format = "[$time]($style)"
style = "bold #6272a4"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# LINE 2: Prompt Character (with battery warning if needed)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[battery]
disabled = false
full_symbol = ""
charging_symbol = ""
discharging_symbol = ""
empty_symbol = "ğŸª« "
format = "[$symbol$percentage]($style) "

[[battery.display]]
threshold = 15
style = "bold red"
discharging_symbol = "âš ï¸ "

[[battery.display]]
threshold = 30
style = "bold yellow"
discharging_symbol = "ğŸ”‹ "

# Above 30% - don't show anything
[[battery.display]]
threshold = 100
style = ""

[character]
success_symbol = "[â¯](bold #50fa7b)"
error_symbol = "[â¯](bold #ff5555)"
vimcmd_symbol = "[â®](bold #bd93f9)"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# DISABLED MODULES (not needed for infra work, reduces clutter)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[python]
disabled = true

[nodejs]
disabled = true

[rust]
disabled = true

[golang]
disabled = true

[aws]
disabled = true

[gcloud]
disabled = true

[azure]
disabled = true

[terraform]
disabled = true

[vagrant]
disabled = true

[nix_shell]
disabled = true

[package]
disabled = true

[hostname]
disabled = true

[username]
disabled = true

[shlvl]
disabled = true

[jobs]
disabled = true
